!function(t){var e={};function i(n){if(e[n])return e[n].exports;var s=e[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)i.d(n,s,function(e){return t[e]}.bind(null,s));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";function n(t){return"string"==typeof t&&(t=document.querySelector(t)),t&&1===t.nodeType?t:(e=`query filed [${t}]`,console.warn(`[dChart]: ${e}`),document.createElement("div"));var e}i.r(e);const s=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","lineCap","lineJoin","lineWidth","miterLimit","font","textAlign","textBaseline"];function r(t,e){return t.currentStyle?t.currentStyle[e]:window.getComputedStyle(t,null)[e]}let o=0;class h{constructor(t){this.points=t.points||[],this.style=t.style||{lineWidth:1,strokeStyle:"#000"},this.needCache=t.needCache||!1,this.name=t.name||`lineid${o++}`}}const a={width:2,borderWidth:0},c={width:5,borderWidth:1};class l{constructor(t){this.x=t.x,this.y=t.y,this.height=t.height,this.fillStyle=t.fillStyle,t.width?this.width=t.width:this.width="small"===t.size?a.width:c.width,this.borderWidth="small"===t.size?a.borderWidth:c.borderWidth}}var d={createLine:function(t){return t instanceof h?t:Array.isArray(t)?new h({points:t}):new h(t)},createRect:function(t){return t instanceof l?t:new l(t)}};var f;function u(t,e,i,n){const s=e[0];t.moveTo(s.x+i,s.y+i),e.forEach(e=>{t.lineTo(e.x+i,e.y+i)}),n&&t.stroke()}function p(t,e){return-parseInt(t*e)}class y{constructor(t){this.init(t)}initContext(t){const e=this.container=n(t.el),i=document.createElement("canvas");e.append(i),this.ctx=i.getContext("2d"),i.height=parseFloat(t.height||r(e,"height")),i.width=parseFloat(t.width||r(e,"width")),i.style.height=i.height+"px",i.style.width=i.width+"px",this.canvas=i,this.canvasHeight=i.height,this.canvasWidth=i.width}initState(t){this.lineMap={},this.PIXOFFSET=.5,this.data=t.data||null,this.chartOffsetX=0}initEvent(){let t=0,e=0;this.canvas.addEventListener("mousedown",e=>{console.log(e.pageX),this.isMouseDown=!0,this.chartOffsetX=this.chartOffsetX,this.mouseDownX=t=e.pageX}),this.canvas.addEventListener("mousemove",e=>{!this.isBusy&&this.isMouseDown&&(this.isBusy=!0,e.pageX!==t&&(this.chartOffsetX+=parseInt(e.pageX-t),this.chartOffsetX>0&&(this.chartOffsetX=0),this.chartOffsetX<-this.maxOffsetX&&(this.chartOffsetX=-this.maxOffsetX),t=e.pageX,this.clearAll(),this.drawRects(this.chartOffsetX)),console.log(this.chartOffsetX,".."),this.isBusy=!1)}),this.canvas.addEventListener("mouseup",t=>{console.log(t.pageX,"up"),this.isMouseDown=!1,this.mouseUpX=e=t.pageX})}init(t){this.initContext(t),this.initState(t),this.initEvent()}}(f=y).prototype.clearAll=function(){this.ctx.clearRect(0,0,this.canvasWidth,this.canvasHeight)},f.prototype.drawLine=function(t){const e=this.ctx;t=d.createLine(t),console.log(t,"line");const i=t.style.lineWidth%2==1?this.PIXOFFSET:0;console.log(i,"PIXOFFSET"),t.isRestore&&e.restore(),t.style&&function(t,e){if(t&&e)for(let i in e)s.indexOf(i)>-1&&(t[i]=e[i])}(e,t.style),t&&t.points&&(Array.isArray(t.points[0])?(e.beginPath(),t.points.forEach(t=>{u(e,t,i)}),e.stroke()):(e.beginPath(),u(e,t.points,i,!0))),t.needCache&&!this.lineMap.hasOwnProperty(t.name)&&(this.lineMap[t.name]=t)},f.prototype.drawRect=function(t){const e=this.ctx;t=d.createRect(t),e.beginPath(),e.fillRect(t.x,t.y,t.width,t.height)},f.prototype.drawRects=function(t=0){const e=[10,20,30,40,50,60,10,20,30,40,50,60,10,20,30,40,50,60],i=function(t,e,i,n="bar"){if("bar"===n)return t/e}(.8*this.canvasHeight,Math.max.apply(null,e));let n;for(let s=0;s<e.length;s++)(n=35*s)<this.canvasWidth&&this.drawRect({x:n+t,y:this.canvasHeight-10,height:p(e[s],i),width:30});this.rectsWidth=n+30,this.maxOffsetX=Math.abs(this.canvasWidth-this.rectsWidth)+5},window.dChart=function(t){return console.count("ss"),new y(t)}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL3V0aWwuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3NoYXBlLmpzIiwid2VicGFjazovLy8uL3NyYy9heGlzL2F4aXMuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2RyYXcuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2RDaGFydC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvaW5kZXguanMiXSwibmFtZXMiOlsiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJxdWVyeSIsImVsIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwibm9kZVR5cGUiLCJtc2ciLCJjb25zb2xlIiwid2FybiIsImNyZWF0ZUVsZW1lbnQiLCJTVFlMRSIsImdldENzcyIsImRvbSIsInB0eSIsImN1cnJlbnRTdHlsZSIsIndpbmRvdyIsImdldENvbXB1dGVkU3R5bGUiLCJfbGluZUlkIiwiTGluZSIsIltvYmplY3QgT2JqZWN0XSIsIm9wdGlvbiIsInRoaXMiLCJwb2ludHMiLCJzdHlsZSIsImxpbmVXaWR0aCIsInN0cm9rZVN0eWxlIiwibmVlZENhY2hlIiwiU01BTExfUkVDVCIsIndpZHRoIiwiYm9yZGVyV2lkdGgiLCJOT1JNQUxfUkVDVCIsIlJlY3QiLCJ4IiwieSIsImhlaWdodCIsImZpbGxTdHlsZSIsInNpemUiLCJzaGFwZSIsImNyZWF0ZUxpbmUiLCJBcnJheSIsImlzQXJyYXkiLCJjcmVhdGVSZWN0IiwiZENoYXJ0IiwiZHJhd0xpbmUiLCJjdHgiLCJQSVhPRkZTRVQiLCJuZWVkU3Ryb2tlIiwic3RhcnRQb2ludCIsIm1vdmVUbyIsImZvckVhY2giLCJwb2ludCIsImxpbmVUbyIsInN0cm9rZSIsImNvbnZlclZhbFRvSGVpZ2h0IiwidW5pdFkiLCJwYXJzZUludCIsImRDaGFydF9EcmF3aW5nQm9hcmQiLCJpbml0IiwiY29udGFpbmVyIiwiY2FudmFzIiwiYXBwZW5kIiwiZ2V0Q29udGV4dCIsInBhcnNlRmxvYXQiLCJjYW52YXNIZWlnaHQiLCJjYW52YXNXaWR0aCIsImxpbmVNYXAiLCJkYXRhIiwiY2hhcnRPZmZzZXRYIiwibW91c2VEb3duWCIsIm1vdXNlVXBYIiwiYWRkRXZlbnRMaXN0ZW5lciIsImUiLCJsb2ciLCJwYWdlWCIsImlzTW91c2VEb3duIiwiaXNCdXN5IiwibWF4T2Zmc2V0WCIsImNsZWFyQWxsIiwiZHJhd1JlY3RzIiwiaW5pdENvbnRleHQiLCJpbml0U3RhdGUiLCJpbml0RXZlbnQiLCJjbGVhclJlY3QiLCJsaW5lIiwiaXNSZXN0b3JlIiwicmVzdG9yZSIsImluZGV4T2YiLCJyZXNldFN0eWxlIiwiYmVnaW5QYXRoIiwiZHJhd1JlY3QiLCJyZWN0IiwiZmlsbFJlY3QiLCJhcnIiLCJtYXhIZWlnaHQiLCJtYXgiLCJtaW4iLCJ0eXBlIiwiZ2V0VW5pdFkiLCJNYXRoIiwiYXBwbHkiLCJzdGFydFgiLCJsZW5ndGgiLCJyZWN0c1dpZHRoIiwiYWJzIiwiY291bnQiXSwibWFwcGluZ3MiOiJhQUNBLElBQUFBLEVBQUEsR0FHQSxTQUFBQyxFQUFBQyxHQUdBLEdBQUFGLEVBQUFFLEdBQ0EsT0FBQUYsRUFBQUUsR0FBQUMsUUFHQSxJQUFBQyxFQUFBSixFQUFBRSxHQUFBLENBQ0FHLEVBQUFILEVBQ0FJLEdBQUEsRUFDQUgsUUFBQSxJQVVBLE9BTkFJLEVBQUFMLEdB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SCxFQUFBUyxPQUFnQnBJLEtBQ25DbUksRUFBQSxHQUFBbkksR0FDQW9ELEtBQUEyQyxhQUNBM0MsS0FBQW9FLFNBQUEsQ0FBdUJ6RCxFQUFBb0UsRUFBQWpDLEVBQUFsQyxFQUFBWixLQUFBMEMsYUFBQSxHQUFBN0IsT0FBQW1CLEVBQUF1QyxFQUFBM0gsR0FBQXFGLEdBQUExQixNQVB2QixLQVVBUCxLQUFBaUYsV0FBQUYsRUFWQSxHQVdBL0UsS0FBQXVELFdBQUFzQixLQUFBSyxJQUFBbEYsS0FBQTJDLFlBQUEzQyxLQUFBaUYsWUFWQSxHRTdDQXZGLE9BQUEyQixPRG1FTyxTQUFldEIsR0FFdEIsT0FEQWIsUUFBQWlHLE1BQUEsTUFDQSxJQUFhaEQsRUFBWXBDIiwiZmlsZSI6ImJ1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAwKTtcbiIsImV4cG9ydCBmdW5jdGlvbiBxdWVyeShlbCkge1xyXG4gIGlmICh0eXBlb2YgZWwgPT09ICdzdHJpbmcnKSB7XHJcbiAgICBlbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZWwpXHJcbiAgfVxyXG4gIGlmIChlbCAmJiBlbC5ub2RlVHlwZSA9PT0gMSkge1xyXG4gICAgcmV0dXJuIGVsXHJcbiAgfVxyXG4gIHdhcm4oYHF1ZXJ5IGZpbGVkIFske2VsfV1gKVxyXG4gIHJldHVybiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxyXG59XHJcblxyXG5jb25zdCBTVFlMRSA9IFsnZmlsbFN0eWxlJywgJ3N0cm9rZVN0eWxlJywgJ3NoYWRvd0NvbG9yJywgJ3NoYWRvd0JsdXInLCAnc2hhZG93T2Zmc2V0WCcsXHJcbidzaGFkb3dPZmZzZXRZJywgJ2xpbmVDYXAnLCAnbGluZUpvaW4nLCAnbGluZVdpZHRoJywgJ21pdGVyTGltaXQnLCAnZm9udCcsICd0ZXh0QWxpZ24nLCAndGV4dEJhc2VsaW5lJywgXVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHJlc2V0U3R5bGUoY3R4LCBzdHlsZSkge1xyXG4gIGlmICghY3R4IHx8ICFzdHlsZSkgcmV0dXJuXHJcbiAgZm9yIChsZXQgcHJvcGVydHkgaW4gc3R5bGUpIHtcclxuICAgIGlmIChTVFlMRS5pbmRleE9mKHByb3BlcnR5KSA+IC0xKSB7XHJcbiAgICAgIGN0eFtwcm9wZXJ0eV0gPSBzdHlsZVtwcm9wZXJ0eV1cclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRDc3MoZG9tLCBwdHkpIHtcclxuICBpZiAoZG9tLmN1cnJlbnRTdHlsZSkge1xyXG4gICAgcmV0dXJuIGRvbS5jdXJyZW50U3R5bGVbcHR5XVxyXG4gIH0gZWxzZSB7XHJcbiAgICByZXR1cm4gd2luZG93LmdldENvbXB1dGVkU3R5bGUoZG9tLCBudWxsKVtwdHldXHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiB3YXJuKG1zZykge1xyXG4gIGNvbnNvbGUud2FybihgW2RDaGFydF06ICR7bXNnfWApXHJcbn1cclxuIiwibGV0IF9saW5lSWQgPSAwXHJcbmxldCBfcmVjdElkID0gMFxyXG5cclxuY2xhc3MgTGluZSB7XHJcbiAgY29uc3RydWN0b3Iob3B0aW9uKSB7XHJcbiAgICB0aGlzLnBvaW50cyA9IG9wdGlvbi5wb2ludHMgfHwgW11cclxuICAgIHRoaXMuc3R5bGUgPSBvcHRpb24uc3R5bGUgfHwge2xpbmVXaWR0aDogMSwgc3Ryb2tlU3R5bGU6ICcjMDAwJ31cclxuICAgIHRoaXMubmVlZENhY2hlID0gb3B0aW9uLm5lZWRDYWNoZSB8fCBmYWxzZVxyXG4gICAgdGhpcy5uYW1lID0gb3B0aW9uLm5hbWUgfHwgYGxpbmVpZCR7X2xpbmVJZCsrfWBcclxuICB9XHJcbn1cclxuXHJcbmNvbnN0IFNNQUxMX1JFQ1QgPSB7XHJcbiAgd2lkdGg6IDIsXHJcbiAgYm9yZGVyV2lkdGg6IDBcclxufVxyXG5jb25zdCBOT1JNQUxfUkVDVCA9IHtcclxuICB3aWR0aDogNSxcclxuICBib3JkZXJXaWR0aDogMVxyXG59XHJcbmNsYXNzIFJlY3Qge1xyXG4gIGNvbnN0cnVjdG9yKG9wdGlvbikge1xyXG4gICAgdGhpcy54ID0gb3B0aW9uLnhcclxuICAgIHRoaXMueSA9IG9wdGlvbi55XHJcbiAgICB0aGlzLmhlaWdodCA9IG9wdGlvbi5oZWlnaHRcclxuICAgIHRoaXMuZmlsbFN0eWxlID0gb3B0aW9uLmZpbGxTdHlsZVxyXG5cclxuICAgIGlmIChvcHRpb24ud2lkdGgpIHtcclxuICAgICAgdGhpcy53aWR0aCA9IG9wdGlvbi53aWR0aFxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy53aWR0aCA9IG9wdGlvbi5zaXplID09PSAnc21hbGwnID8gU01BTExfUkVDVC53aWR0aCA6IE5PUk1BTF9SRUNULndpZHRoXHJcbiAgICB9XHJcbiAgICB0aGlzLmJvcmRlcldpZHRoID0gb3B0aW9uLnNpemUgPT09ICdzbWFsbCcgPyBTTUFMTF9SRUNULmJvcmRlcldpZHRoIDogTk9STUFMX1JFQ1QuYm9yZGVyV2lkdGhcclxuXHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCB7XHJcbiAgY3JlYXRlTGluZTogZnVuY3Rpb24ob3B0aW9uKSB7XHJcbiAgICBpZiAob3B0aW9uIGluc3RhbmNlb2YgTGluZSkgcmV0dXJuIG9wdGlvblxyXG4gICAgaWYgKEFycmF5LmlzQXJyYXkob3B0aW9uKSkgcmV0dXJuIG5ldyBMaW5lKHtwb2ludHM6IG9wdGlvbn0pXHJcbiAgICByZXR1cm4gbmV3IExpbmUob3B0aW9uKVxyXG4gIH0sXHJcbiAgY3JlYXRlUmVjdDogZnVuY3Rpb24ob3B0aW9uKSB7XHJcbiAgICBpZiAob3B0aW9uIGluc3RhbmNlb2YgUmVjdCkgcmV0dXJuIG9wdGlvblxyXG4gICAgcmV0dXJuIG5ldyBSZWN0KG9wdGlvbilcclxuICB9XHJcbn1cclxuIiwiY2xhc3MgQXhpcyB7XHJcbiAgY29uc3RydWN0b3Iob3B0aW9uKSB7XHJcbiAgICB0aGlzLm5hbWUgPSBvcHRpb24ubmFtZSB8fCAnJ1xyXG4gICAgdGhpcy50eXBlID0gb3B0aW9uLnR5cGUgfHwgJ3ZhbHVlJ1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgQXhpcyIsImltcG9ydCB7cmVzZXRTdHlsZX0gZnJvbSAnLi91dGlsLmpzJ1xyXG5pbXBvcnQgc2hhcGUgZnJvbSAnLi9zaGFwZS5qcydcclxuaW1wb3J0ICcuL2F4aXMveUF4aXMuanMnXHJcblxyXG5leHBvcnQgZnVuY3Rpb24gaW5pdERyYXcoZENoYXJ0KSB7XHJcbiAgZENoYXJ0LnByb3RvdHlwZS5jbGVhckFsbCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgdGhpcy5jdHguY2xlYXJSZWN0KDAsMCwgdGhpcy5jYW52YXNXaWR0aCwgdGhpcy5jYW52YXNIZWlnaHQpXHJcbiAgfSxcclxuICBkQ2hhcnQucHJvdG90eXBlLmRyYXdMaW5lID0gZnVuY3Rpb24obGluZSkge1xyXG4gICAgY29uc3QgY3R4ID0gdGhpcy5jdHhcclxuICAgIGxpbmUgPSBzaGFwZS5jcmVhdGVMaW5lKGxpbmUpXHJcbiAgICBjb25zb2xlLmxvZyhsaW5lLCAnbGluZScpXHJcbiAgICBjb25zdCBQSVhPRkZTRVQgPSBsaW5lLnN0eWxlLmxpbmVXaWR0aCAlIDIgPT09IDEgPyB0aGlzLlBJWE9GRlNFVCA6IDBcclxuICAgIGNvbnNvbGUubG9nKFBJWE9GRlNFVCwgJ1BJWE9GRlNFVCcpXHJcbiAgICBpZiAobGluZS5pc1Jlc3RvcmUpIGN0eC5yZXN0b3JlKClcclxuICAgIGlmIChsaW5lLnN0eWxlKSByZXNldFN0eWxlKGN0eCwgbGluZS5zdHlsZSlcclxuICAgIGlmIChsaW5lICYmIGxpbmUucG9pbnRzKSB7XHJcbiAgICAgIGlmIChBcnJheS5pc0FycmF5KGxpbmUucG9pbnRzWzBdKSkge1xyXG4gICAgICAgIGN0eC5iZWdpblBhdGgoKVxyXG4gICAgICAgIGxpbmUucG9pbnRzLmZvckVhY2goKHBvaW50cykgPT4ge1xyXG4gICAgICAgICAgZHJhd0xpbmUoY3R4LCBwb2ludHMsIFBJWE9GRlNFVClcclxuICAgICAgICB9KVxyXG4gICAgICAgIGN0eC5zdHJva2UoKVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGN0eC5iZWdpblBhdGgoKVxyXG4gICAgICAgIGRyYXdMaW5lKGN0eCwgbGluZS5wb2ludHMsIFBJWE9GRlNFVCwgdHJ1ZSlcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgaWYgKGxpbmUubmVlZENhY2hlICYmICF0aGlzLmxpbmVNYXAuaGFzT3duUHJvcGVydHkobGluZS5uYW1lKSkge1xyXG4gICAgICB0aGlzLmxpbmVNYXBbbGluZS5uYW1lXSA9IGxpbmVcclxuICAgIH1cclxuICB9LFxyXG4gIGRDaGFydC5wcm90b3R5cGUuZHJhd1JlY3QgPSBmdW5jdGlvbihyZWN0KSB7XHJcbiAgICBjb25zdCBjdHggPSB0aGlzLmN0eFxyXG4gICAgcmVjdCA9IHNoYXBlLmNyZWF0ZVJlY3QocmVjdClcclxuICAgIGN0eC5iZWdpblBhdGgoKVxyXG4gICAgLy8gaWYgKHJlY3QuYm9yZGVyV2lkdGgpIHtcclxuICAgICAgY3R4LmZpbGxSZWN0KHJlY3QueCwgcmVjdC55LCByZWN0LndpZHRoLCByZWN0LmhlaWdodClcclxuICAgICAgLy8gY3R4LnN0cm9rZSgpXHJcbiAgICAgIC8vIGN0eC5maWxsKClcclxuICAgIC8vIH1cclxuICB9XHJcblxyXG4gIGRDaGFydC5wcm90b3R5cGUuZHJhd1JlY3RzID0gZnVuY3Rpb24oY2hhcnRPZmZzZXRYID0gMCkge1xyXG4gICAgY29uc3QgYXJyID0gWzEwLCAyMCwgMzAsIDQwLCA1MCwgNjAsIDEwLCAyMCwgMzAsIDQwLCA1MCwgNjAsIDEwLCAyMCwgMzAsIDQwLCA1MCwgNjBdXHJcbiAgICBjb25zdCBiYXJXaWR0aCA9IDMwXHJcbiAgICBjb25zdCBnYXAgPSA1XHJcbiAgICBjb25zdCB1bml0WSA9IGdldFVuaXRZKHRoaXMuY2FudmFzSGVpZ2h0ICogMC44LCBNYXRoLm1heC5hcHBseShudWxsLCBhcnIpKVxyXG4gICAgbGV0IHN0YXJ0WFxyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhcnIubGVuZ3RoOyBpKyspIHtcclxuICAgICAgc3RhcnRYID0gaSAqIChiYXJXaWR0aCArIGdhcClcclxuICAgICAgaWYgKHN0YXJ0WCA8IHRoaXMuY2FudmFzV2lkdGgpIHtcclxuICAgICAgICB0aGlzLmRyYXdSZWN0KHt4OiBzdGFydFggKyBjaGFydE9mZnNldFgsIHk6IHRoaXMuY2FudmFzSGVpZ2h0IC0gMTAsICBoZWlnaHQ6IGNvbnZlclZhbFRvSGVpZ2h0KGFycltpXSwgdW5pdFkpLCB3aWR0aDogYmFyV2lkdGh9KVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICB0aGlzLnJlY3RzV2lkdGggPSBzdGFydFggKyBiYXJXaWR0aFxyXG4gICAgdGhpcy5tYXhPZmZzZXRYID0gTWF0aC5hYnModGhpcy5jYW52YXNXaWR0aCAtIHRoaXMucmVjdHNXaWR0aCkgKyBnYXBcclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGRyYXdMaW5lKGN0eCwgcG9pbnRzLCBQSVhPRkZTRVQsIG5lZWRTdHJva2UpIHtcclxuICBjb25zdCBzdGFydFBvaW50ID0gcG9pbnRzWzBdXHJcbiAgY3R4Lm1vdmVUbyhzdGFydFBvaW50LnggKyBQSVhPRkZTRVQsIHN0YXJ0UG9pbnQueSArIFBJWE9GRlNFVClcclxuICBwb2ludHMuZm9yRWFjaCgocG9pbnQpID0+IHtcclxuICAgIGN0eC5saW5lVG8ocG9pbnQueCArIFBJWE9GRlNFVCwgcG9pbnQueSArIFBJWE9GRlNFVClcclxuICB9KVxyXG4gIGlmIChuZWVkU3Ryb2tlKSBjdHguc3Ryb2tlKClcclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0VW5pdFkobWF4SGVpZ2h0LCBtYXgsIG1pbiwgdHlwZSA9ICdiYXInKSB7XHJcbiAgaWYgKHR5cGUgPT09ICdiYXInKSB7XHJcbiAgICByZXR1cm4gbWF4SGVpZ2h0IC8gbWF4IFxyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gY29udmVyVmFsVG9IZWlnaHQodmFsdWUsIHVuaXRZKSB7XHJcbiAgbGV0IHYgPSBwYXJzZUludCh2YWx1ZSAqIHVuaXRZKVxyXG4gIHJldHVybiAtdlxyXG59IiwiaW1wb3J0IHtxdWVyeSwgZ2V0Q3NzfSBmcm9tICcuL3V0aWwnO1xyXG5pbXBvcnQge2luaXREcmF3fSBmcm9tICcuL2RyYXcuanMnXHJcblxyXG5jbGFzcyBEcmF3aW5nQm9hcmQge1xyXG4gIGNvbnN0cnVjdG9yKG9wdGlvbikge1xyXG4gICAgdGhpcy5pbml0KG9wdGlvbilcclxuICB9XHJcbiAgaW5pdENvbnRleHQob3B0aW9uKSB7XHJcbiAgICBjb25zdCBjb250YWluZXIgPSB0aGlzLmNvbnRhaW5lciA9IHF1ZXJ5KG9wdGlvbi5lbCk7XHJcbiAgICBjb25zdCBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTtcclxuXHJcbiAgICBjb250YWluZXIuYXBwZW5kKGNhbnZhcyk7XHJcbiAgICB0aGlzLmN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpXHJcblxyXG4gICAgY2FudmFzLmhlaWdodCA9IHBhcnNlRmxvYXQob3B0aW9uLmhlaWdodCB8fCBnZXRDc3MoY29udGFpbmVyLCAnaGVpZ2h0JykpO1xyXG4gICAgY2FudmFzLndpZHRoID0gcGFyc2VGbG9hdChvcHRpb24ud2lkdGggfHwgZ2V0Q3NzKGNvbnRhaW5lciwgJ3dpZHRoJykpO1xyXG4gICAgY2FudmFzLnN0eWxlLmhlaWdodCA9IGNhbnZhcy5oZWlnaHQgKyAncHgnO1xyXG4gICAgY2FudmFzLnN0eWxlLndpZHRoID0gY2FudmFzLndpZHRoICsgJ3B4JztcclxuICAgIHRoaXMuY2FudmFzID0gY2FudmFzXHJcbiAgICB0aGlzLmNhbnZhc0hlaWdodCA9IGNhbnZhcy5oZWlnaHRcclxuICAgIHRoaXMuY2FudmFzV2lkdGggPSBjYW52YXMud2lkdGhcclxuICB9XHJcbiAgaW5pdFN0YXRlKG9wdGlvbikge1xyXG4gICAgLy8g5Yid5aeL5YyW6YWN572uXHJcbiAgICB0aGlzLmxpbmVNYXAgPSB7fVxyXG4gICAgdGhpcy5QSVhPRkZTRVQgPSAwLjVcclxuICAgIHRoaXMuZGF0YSA9IG9wdGlvbi5kYXRhIHx8IG51bGxcclxuICAgIHRoaXMuY2hhcnRPZmZzZXRYID0gMFxyXG4gIH1cclxuICBpbml0RXZlbnQoKSB7XHJcbiAgICBsZXQgbW91c2VEb3duWCA9IDBcclxuICAgIGxldCBtb3VzZVVwWCA9IDBcclxuICAgIHRoaXMuY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIChlKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGUucGFnZVgpXHJcbiAgICAgIHRoaXMuaXNNb3VzZURvd24gPSB0cnVlXHJcbiAgICAgIHRoaXMuY2hhcnRPZmZzZXRYID0gdGhpcy5jaGFydE9mZnNldFhcclxuICAgICAgdGhpcy5tb3VzZURvd25YID0gbW91c2VEb3duWCA9IGUucGFnZVhcclxuICAgIH0pXHJcbiAgICB0aGlzLmNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCAoZSkgPT4ge1xyXG4gICAgICBpZiAoIXRoaXMuaXNCdXN5ICYmIHRoaXMuaXNNb3VzZURvd24pIHtcclxuICAgICAgICB0aGlzLmlzQnVzeSA9IHRydWVcclxuICAgICAgICBpZiAoZS5wYWdlWCAhPT0gbW91c2VEb3duWCkge1xyXG4gICAgICAgICAgdGhpcy5jaGFydE9mZnNldFggKz0gcGFyc2VJbnQoZS5wYWdlWCAtIG1vdXNlRG93blgpXHJcbiAgICAgICAgICBpZih0aGlzLmNoYXJ0T2Zmc2V0WCA+IDApIHRoaXMuY2hhcnRPZmZzZXRYID0gMFxyXG4gICAgICAgICAgaWYodGhpcy5jaGFydE9mZnNldFggPCAtdGhpcy5tYXhPZmZzZXRYKSB0aGlzLmNoYXJ0T2Zmc2V0WCA9IC10aGlzLm1heE9mZnNldFhcclxuICAgICAgICAgIG1vdXNlRG93blggPSBlLnBhZ2VYXHJcbiAgICAgICAgICB0aGlzLmNsZWFyQWxsKClcclxuICAgICAgICAgIHRoaXMuZHJhd1JlY3RzKHRoaXMuY2hhcnRPZmZzZXRYKVxyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zb2xlLmxvZyh0aGlzLmNoYXJ0T2Zmc2V0WCwgJy4uJylcclxuICAgICAgICB0aGlzLmlzQnVzeSA9IGZhbHNlXHJcbiAgICAgIH1cclxuICAgIH0pXHJcbiAgICB0aGlzLmNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgKGUpID0+IHtcclxuICAgICAgY29uc29sZS5sb2coZS5wYWdlWCwgJ3VwJylcclxuICAgICAgdGhpcy5pc01vdXNlRG93biA9IGZhbHNlXHJcbiAgICAgIHRoaXMubW91c2VVcFggPSBtb3VzZVVwWCA9IGUucGFnZVhcclxuICAgIH0pXHJcbiAgfVxyXG4gIGluaXQob3B0aW9uKSB7XHJcbiAgICB0aGlzLmluaXRDb250ZXh0KG9wdGlvbilcclxuICAgIHRoaXMuaW5pdFN0YXRlKG9wdGlvbilcclxuICAgIHRoaXMuaW5pdEV2ZW50KClcclxuICB9XHJcbn1cclxuXHJcbmluaXREcmF3KERyYXdpbmdCb2FyZCk7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZENoYXJ0KG9wdGlvbikge1xyXG4gIGNvbnNvbGUuY291bnQoJ3NzJylcclxuICByZXR1cm4gbmV3IERyYXdpbmdCb2FyZChvcHRpb24pXHJcbn0iLCJpbXBvcnQge2RDaGFydH0gZnJvbSAnLi9kQ2hhcnQuanMnXHJcbndpbmRvdy5kQ2hhcnQgPSBkQ2hhcnQiXSwic291cmNlUm9vdCI6IiJ9